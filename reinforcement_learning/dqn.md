# DQN –≥—ç–∂ —é—É –≤—ç? 

## DQN (Deep Q-Network) –≥—ç–¥—ç–≥ –Ω—å
- üëâ ‚Äú—è–º–∞—Ä —Ç”©–ª”©–≤—Ç —è–º–∞—Ä “Ø–π–ª–¥—ç–ª —Ö–∏–π—Ö –Ω—å —Ö–∞–º–≥–∏–π–Ω –∞—à–∏–≥—Ç–∞–π –≤—ç?‚Äù
–≥—ç—Å—ç–Ω –∞—Å—É—É–ª—Ç–∞–¥ –Ω–µ–π—Ä–æ–Ω —Å“Ø–ª–∂—ç—ç–≥—ç—ç—Ä —Ö–∞—Ä–∏—É–ª–∞—Ö –∞—Ä–≥–∞ —é–º.

‚∏ª

## 1. –ê–≥–µ–Ω—Ç, –æ—Ä—á–∏–Ω, —à–∞–≥–Ω–∞–ª (Agent, environment, reward)

–¢–æ–≥–ª–æ–æ–º —Ç–æ–≥–ª–æ–∂ –±—É–π —Ä–æ–±–æ—Ç –±–∞–π–Ω–∞ –≥—ç–∂ —Ç”©—Å”©”©–ª—å–µ.
	‚Ä¢	–¢”©–ª”©–≤ (State) ‚Äì –æ–¥–æ–æ–≥–∏–π–Ω –±–∞–π–¥–∞–ª (–¥—ç–ª–≥—ç—Ü, –∑—É—Ä–∞–≥, –æ—Ä—á–Ω—ã –º—ç–¥—ç—ç–ª—ç–ª)
	‚Ä¢	“Æ–π–ª–¥—ç–ª (Action) ‚Äì –∑“Ø“Ø–Ω —Ç–∏–π—à —è–≤–∞—Ö, –±–∞—Ä—É—É–Ω —Ç–∏–π—à —è–≤–∞—Ö –≥—ç—Ö –º—ç—Ç
	‚Ä¢	–®–∞–≥–Ω–∞–ª (Reward) ‚Äì —Å–∞–π–Ω –∑“Ø–π–ª —Ö–∏–π–≤—ç–ª +–æ–Ω–æ–æ, –º—É—É –∑“Ø–π–ª —Ö–∏–π–≤—ç–ª ‚àí–æ–Ω–æ–æ

### –ê–≥–µ–Ω—Ç—ã–Ω –∑–æ—Ä–∏–ª–≥–æ:

–ù–∏–π—Ç —à–∞–≥–Ω–∞–ª–∞–∞ –∞–ª—å –±–æ–ª–æ—Ö –∏—Ö –±–æ–ª–≥–æ—Ö

‚∏ª

## 2. –ò—Ä—ç—ç–¥“Ø–π–Ω —à–∞–≥–Ω–∞–ª—ã–≥ —è–∞–∂ —Ç–æ–æ—Ü–æ—Ö –≤—ç?

–ê–≥–µ–Ω—Ç –∑”©–≤—Ö”©–Ω –æ–¥–æ–æ–≥–∏–π–Ω —à–∞–≥–Ω–∞–ª–∞–∞—Ä –±–∏—à, –∏—Ä—ç—ç–¥“Ø–π–¥ –∞–≤–∞—Ö —à–∞–≥–Ω–∞–ª—ã–≥ –±–∞—Å –±–æ–¥–æ–ª—Ü–æ–Ω–æ.

–¢–∏–π–º—ç—ç—Å:
	‚Ä¢	–û–π—Ä—ã–Ω —à–∞–≥–Ω–∞–ª ‚Üí –∏–ª“Ø“Ø —á—É—Ö–∞–ª
	‚Ä¢	–•–æ–ª—ã–Ω –∏—Ä—ç—ç–¥“Ø–π–Ω —à–∞–≥–Ω–∞–ª ‚Üí –∞—Ä–∞–π –±–∞–≥–∞ —á—É—Ö–∞–ª

“Æ“Ø–Ω–∏–π–≥ Œ≥ (–≥–∞–º–º–∞) –≥—ç–¥—ç–≥ —Ç–æ–æ–≥–æ–æ—Ä –∑–æ—Ö–∏—Ü—É—É–ª–Ω–∞.
	‚Ä¢	Œ≥ ‚âà 0 ‚Üí ‚Äú–û–¥–æ–æ –∞–≤—Å–∞–Ω —à–∞–≥–Ω–∞–ª –ª —á—É—Ö–∞–ª‚Äù
	‚Ä¢	Œ≥ ‚âà 1 ‚Üí ‚Äú–ò—Ä—ç—ç–¥“Ø–π —á –±–∞—Å –º–∞—à —á—É—Ö–∞–ª‚Äù

‚∏ª

## 3. Q —Ñ—É–Ω–∫—Ü –≥—ç–∂ —é—É –≤—ç?

Q(s, a) –≥—ç–¥—ç–≥ –Ω—å:

‚Äú–≠–Ω—ç —Ç”©–ª”©–≤—Ç (s) —ç–Ω—ç “Ø–π–ª–¥–ª–∏–π–≥ (a) —Ö–∏–π–≤—ç–ª
–∏—Ä—ç—ç–¥“Ø–π–¥ –Ω–∏–π—Ç —Ö—ç–¥—ç–Ω —à–∞–≥–Ω–∞–ª –∞–≤–∞—Ö –±–æ–ª?‚Äù

–≥—ç—Å—ç–Ω –∞—Å—É—É–ª—Ç—ã–Ω —Ö–∞—Ä–∏—É.

–ñ–∏—à—ç—ç:
	‚Ä¢	Q(–æ–¥–æ–æ, –∑“Ø“Ø–Ω) = 5
	‚Ä¢	Q(–æ–¥–æ–æ, –±–∞—Ä—É—É–Ω) = 10

üëâ –¢—ç–≥–≤—ç–ª –±–∞—Ä—É—É–Ω —Ç–∏–π—à —è–≤–∞—Ö –Ω—å –∏–ª“Ø“Ø –∞—à–∏–≥—Ç–∞–π.

‚∏ª

## 4. –Ø–∞–≥–∞–∞–¥ –Ω–µ–π—Ä–æ–Ω —Å“Ø–ª–∂—ç—ç —Ö—ç—Ä—ç–≥—Ç—ç–π –≤—ç?

–ë–æ–¥–∏—Ç –æ—Ä—á–∏–Ω–¥:
	‚Ä¢	–¢”©–ª”©–≤ –º–∞—à –æ–ª–æ–Ω
	‚Ä¢	Q-–≥ —è–≥ –±–æ–¥–æ–æ–¥ –≥–∞—Ä–≥–∞—Ö –±–æ–ª–æ–º–∂–≥“Ø–π

–¢–∏–π–º—ç—ç—Å:
üëâ Q —Ñ—É–Ω–∫—Ü–∏–π–≥ –Ω–µ–π—Ä–æ–Ω —Å“Ø–ª–∂—ç—ç–≥—ç—ç—Ä –æ–π—Ä–æ–ª—Ü–æ–æ–ª–Ω–æ

“Æ“Ø–Ω–∏–π–≥ –ª Deep Q-Network (DQN) –≥—ç–∂ –Ω—ç—Ä–ª—ç–¥—ç–≥.

‚∏ª

## 5. –ê–≥–µ–Ω—Ç —è–∞–∂ —Å—É—Ä–∞–ª—Ü–¥–∞–≥ –≤—ç?

–ê–≥–µ–Ω—Ç –∏–Ω–≥—ç–∂ —Å—É—Ä–∞–ª—Ü–∞–Ω–∞:
	1.	–Ø–º–∞—Ä –Ω—ç–≥ “Ø–π–ª–¥—ç–ª —Ö–∏–π–Ω—ç
	2.	–®–∞–≥–Ω–∞–ª –∞–≤–Ω–∞
	3.	–®–∏–Ω—ç —Ç”©–ª”©–≤—Ç –æ—Ä–Ω–æ
	4.	‚Äú–ë–∏ “Ø“Ø–Ω–∏–π–≥ —Ö–∏–π—Ö–¥—ç—ç –∑”©–≤ –±–∞–π—Å–∞–Ω —É—É?‚Äù –≥—ç–∂ ”©”©—Ä–∏–π–≥”©”© —à–∞–ª–≥–∞–Ω–∞

–≠–Ω–¥ –≥–∞—Ä—á –∏—Ä–¥—ç–≥ –∑“Ø–π–ª –±–æ–ª:

‚õî –ê–ª–¥–∞–∞ (Temporal Difference Error)

‚Äú–ë–∏ –∏–Ω–≥—ç–∂ –±–æ–¥—Å–æ–Ω,
—Ö–∞—Ä–∏–Ω –±–æ–¥–∏—Ç –±–∞–π–¥–∞–ª–¥ –∏–Ω–≥—ç–∂ –±–æ–ª—Å–æ–Ω‚Äù

–≠–Ω—ç –∑”©—Ä“Ø“Ø–≥ Œ¥ (delta) –≥—ç–∂ –Ω—ç—Ä–ª—ç–Ω—ç.

‚∏ª

## 6. –ê–ª–¥–∞–∞–≥ —è–∞–∂ –±–∞–≥–∞—Å–≥–∞—Ö –≤—ç?

–ê–ª–¥–∞–∞ –∏—Ö –±–∞–π–≤–∞–ª:
	‚Ä¢	–Ω–µ–π—Ä–æ–Ω —Å“Ø–ª–∂—ç—ç–≥ –∑–∞—Å–Ω–∞
	‚Ä¢	–¥–∞—Ä–∞–∞–≥–∏–π–Ω —É–¥–∞–∞ –∏–ª“Ø“Ø –∑”©–≤ —Ç–∞–∞–º–∞–≥–ª–∞–Ω–∞

–≠–Ω–¥ Huber loss –≥—ç–¥—ç–≥ –∞–ª–¥–∞–≥–¥–ª—ã–Ω —Ñ—É–Ω–∫—Ü –∞—à–∏–≥–ª–∞–¥–∞–≥.

–≠–Ω–≥–∏–π–Ω—ç—ç—Ä:
	‚Ä¢	–ê–ª–¥–∞–∞ –±–∞–≥–∞ ‚Üí –∑”©”©–ª”©–Ω –∑–∞—Å–Ω–∞
	‚Ä¢	–ê–ª–¥–∞–∞ –∏—Ö ‚Üí —Ö—ç—Ç —Ö“Ø—á—Ç—ç–π —à–∏–π—Ç–≥—ç—Ö–≥“Ø–π

üëâ –ò–Ω–≥—ç—Å–Ω—ç—ç—Ä —Å—É—Ä–≥–∞–ª—Ç —Ç–æ–≥—Ç–≤–æ—Ä—Ç–æ–π –±–æ–ª–¥–æ–≥

‚∏ª

## 7. Q-Network —é—É –≥–∞—Ä–≥–∞–¥–∞–≥ –≤—ç?

Q-Network:
	‚Ä¢	–û—Ä–æ–ª—Ç ‚Üí –æ–¥–æ–æ–≥–∏–π–Ω –±–∞–π–¥–∞–ª
	‚Ä¢	–ì–∞—Ä–∞–ª—Ç ‚Üí “Ø–π–ª–¥—ç–ª –±“Ø—Ä–∏–π–Ω –∞—à–∏–≥

–ñ–∏—à—ç—ç:
```
–û—Ä–æ–ª—Ç: –æ–¥–æ–æ–≥–∏–π–Ω –¥—ç–ª–≥—ç—Ü
–ì–∞—Ä–∞–ª—Ç:
  –ó“Ø“Ø–Ω = 3.2
  –ë–∞—Ä—É—É–Ω = 7.8
```
üëâ –ê–≥–µ–Ω—Ç —Ö–∞–º–≥–∏–π–Ω –∏—Ö —É—Ç–≥–∞—Ç–∞–π “Ø–π–ª–¥–ª–∏–π–≥ —Å–æ–Ω–≥–æ–Ω–æ.

‚∏ª

## 8. –ù—ç–≥ ”©–≥“Ø“Ø–ª–±—ç—Ä—ç—ç—Ä –¥“Ø–≥–Ω—ç—Ö—ç–¥

DQN –≥—ç–¥—ç–≥ –Ω—å —Ç—É—Ä—à–ª–∞–≥–∞–∞—Å–∞–∞ —Å—É—Ä–∞–ª—Ü–∞–∂,
‚Äú—è–º–∞—Ä “Ø–π–ª–¥—ç–ª –∏—Ä—ç—ç–¥“Ø–π–¥ —Ö–∞–º–≥–∏–π–Ω –∞—à–∏–≥—Ç–∞–π –≤—ç?‚Äù
–≥—ç–¥–≥–∏–π–≥ –Ω–µ–π—Ä–æ–Ω —Å“Ø–ª–∂—ç—ç–≥—ç—ç—Ä —Å—É—Ä–¥–∞–≥ –∞—Ä–≥–∞ —é–º.

‚∏ª

